{% extends 'application.njk' %}
{% block head %}
  <!-- ===== [1] ===== -->
  <style>
    .verse {
      font-family: monospace;
      margin: 0 0 1em 1em;
    }
  </style>
{% endblock %}

{% block content %}
  <p>
    <button id="restart" type="button">Restart</button> 
  </p>
  <!-- ===== [2] ===== -->
  <div id="song"></div>
  
  <script>
    (function () {
      var song = document.getElementById('song');
      var btnRestart = document.getElementById('restart');

      /* ===== [3] ===== */
      var VERSE_LINES = [
        'This is the song that doesn\'t end',
        'Yes, it goes on and on my friend',
        'Some people started singing it, not knowing what it was',
        'And they\'ll continue singing it forever just because'
      ];

      /* ===== [4] ===== */
      function sing () {
        /* <div></div> */
        var newVerse = document.createElement('div');
        /* <div class="verse"></div> */
        newVerse.classList.add('verse');

        VERSE_LINES.forEach(function (_line) {
          /* <div></div> */
          var elLine = document.createElement('div');
          /* <div class="line"></div> */
          elLine.classList.add('line');
          /* <div class="line">...</div> */
          elLine.innerText = _line;

          newVerse.appendChild(elLine);
        });

        song.appendChild(newVerse);
      }

      // Start Singing
      sing();
      // Keep singing... forever
      window.setInterval(sing, 5000);

      // Wire up "Restart" behavior
      btnRestart.addEventListener('click', function () {
        song.innerHTML = '';
      });
    })();
  </script>

  <!--
    PROBLEM:
    
    HTML for each verse is generated using low level 
    DOM API functions. [3][4]

    While it works, it's not easy to grok.
  -->
{% endblock %}
